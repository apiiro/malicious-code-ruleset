rules:
  - id: go-obfuscation-conditions
    patterns:
      - pattern-either:
        - pattern: if $VAR { ... }
        - pattern: for $VAR { ... }
        - pattern: |
            switch $VAR {
            case ...
            }
      - metavariable-regex:
          metavariable: $VAR
          # Match all non-literals and the listed literals.
          regex: ^(((?![a-zA-Z_!]).+(?<![a-zA-Z_]))|true|false)$
    message:  Detect obfuscation by spurious conditions.
    severity: WARNING
    languages:
      - go
