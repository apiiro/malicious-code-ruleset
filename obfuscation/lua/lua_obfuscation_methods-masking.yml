rules:
  - id: lua-obfuscation-reconstruction
    pattern-either:
      - pattern-regex: (?<!\w)(\.\.|concat|gsub|ipairs|toString)(?!\w)(.*(?<!\w)\1(?!\w)){3,}
      - pattern-regex: (\.(char|format|rep)\()(.*\.\1\(){3,}
    message: Obfuscation by concatenation of a repeating string manipulating method.
    severity: WARNING
    languages:
      - lua
