rules:
  - id: python-suspicious-declaration-names
    patterns:
      - pattern-either:
          - patterns:
              - pattern: $VAR = ...
              - pattern-not: $X.$Y = ...
              - pattern-not: $X[...] = ...
              - pattern-not: $X(...) = ...
          - patterns:
              - pattern: import $VAR
              - pattern-not: from $MODULE import $METHOD
          - patterns:
              - pattern: import $IMPORT as $VAR
              - pattern-not: from $MODULE import $METHOD as $X
          - pattern: from $MODULE import $VAR
          - pattern: from $MODULE import $IMPORT as $VAR
          - pattern: |
              def $VAR(...):
                ...
          - pattern: |
              class $VAR:
                ...
      - metavariable-pattern:
          metavariable: $VAR
          pattern-regex: ^\d|(.)\1{2,}|.{64,}|^_0x|([^a-zA-Z0-9_.()])
    message: Obfuscated declarations names.
    severity: ERROR
    languages: 
      - python