rules:
  - id: javascript-obfuscation-methods-masking
    pattern-either:
      - pattern-regex: (atob\(|Buffer\.from|charCodeAt|decode|encode|fromCharCode|function)(.*\1){2,}
      - pattern-regex: (indexOf|\.join\(|Math\.random|parseInt|\.replace|\.reverse|substr)(.*\1){2,}
      - pattern-regex: (TextDecoder|toString)(.*\1){2,}
    message: Obfuscation by concatenation of string manipulating methods.
    severity: WARNING
    languages: 
      - javascript
      - typescript