rules:
  - id: javascript-obfuscation-reconstruction
    pattern-either:
      - patterns:
          - pattern-either:
              - pattern: $CONCAT.join(...)
              - pattern: |
                  $VAR = $CONCAT
                  ...
                  $VAR.join(...)
          - metavariable-pattern:
              metavariable: $CONCAT
              pattern-regex: \[\s*((((["'])(?:(?!\4).)*\4)|(\d+|(0|\\{1,})[beoux]\d+))\s*,\s*){5,}(((((["'])(?:(?!\11).)))*\11)|(\d+|(0|\\{1,})[beoux]\d+))\s*\]
      - pattern: $VAR = [$CHAR, ...].map($C => String.fromCharCode($C)).join('');
    message: Detect obfuscation by reconstruction of hardcoded data.
    severity: WARNING
    languages: 
      - javascript
      - typescript