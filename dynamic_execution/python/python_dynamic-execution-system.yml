rules:
  - id: python-dynamic-execution-system
    pattern-either:
      - pattern: $VAR = os
      - pattern: $VAR = subprocess
      - pattern: $VAR = os.$CMD
      - pattern: $VAR = subprocess.$CMD
      - pattern: |
          subprocess.$CMD(['python', '-c', '...']);
      - pattern: |
          os.$CMD(..., '...', 'python', '-c', '...')
      - pattern: |
          os.$CMD('...', ['python', '-c', '...'])
      - patterns:
          - pattern-either:
              - pattern: |
                  os.$CMD($STR);
              - pattern: |
                  $VAR = $STR
                  ...
                  os.$CMD($VAR)
          - metavariable-regex:
              metavariable: $STR
              regex: .*python -c.*
    message: Language code dynamic execution using system commands.
    severity: ERROR
    languages:
      - python
