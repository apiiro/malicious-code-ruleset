rules:
  - id: python-dynamic-execution-system
    pattern-either:
      - pattern: $VAR = os
      - pattern: $VAR = subprocess
      - patterns:
          - pattern-either:
              - pattern: |
                  os.$CMD($STR);
              - pattern: |
                  $VAR = $STR
                  ...
                  os.$CMD($VAR)
          - metavariable-regex:
              metavariable: $STR
              regex: .*(python|bash) -c.*
      - patterns:
          - pattern-either:
              - pattern: |
                  subprocess.$CMD(['$LANG', '-c', '...']);
              - pattern: |
                  os.$CMD(..., '...', '$LANG', '-c', '...')
              - pattern: |
                  os.$CMD('...', ['$LANG', '-c', '...'])
          - metavariable-regex:
              metavariable: $LANG
              regex: (python|bash)
    message: Dynamic execution using system commands.
    severity: ERROR
    languages:
      - python
